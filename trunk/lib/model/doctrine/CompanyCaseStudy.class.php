<?php

/**
 * CompanyCaseStudy
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 *
 * @package    symfony
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class CompanyCaseStudy extends BaseCompanyCaseStudy {

    public function getSector() {
        return ($this->getEmpresaSectorTres() && $this->getEmpresaSectorTres()->getId()) ? $this->getEmpresaSectorTres() : $this->getEmpresaSectorDos();
    }

    public function getActividadName() {
        return ($this->getEmpresaSectorTres() && $this->getEmpresaSectorTres()->getId()) ? $this->getEmpresaSectorTres() : '';
    }

    public function getActividad() {
        return ($this->getEmpresaSectorTres() && $this->getEmpresaSectorTres()->getId()) ? $this->getEmpresaSectorTres() : '';
    }

    public function getSectorName() {
        return $this->getEmpresaSectorUnoId() ? $this->getEmpresaSectorUno() : '';
    }

    public function getSubSectorName() {
        return $this->getEmpresaSectorDosId() ? $this->getEmpresaSectorDos() : '';
    }

    public function getSectorId() {
        return $this->getEmpresaSectorTres()->getId() ? $this->getEmpresaSectorTres()->getId() : $this->getEmpresaSectorDos()->getId();
    }

    public function getCityName() {
        return $this->getLocalidad()->getName();
    }

    public function getStatesname() {
        return $this->getStates()->getName();
    }

    /**
     * Devuelve el municipio y provincia. Si la localidad es capital, solo devuelve el municipio.
     *
     * @return string|City
     */
    public function getMunicipioProvincia($codigoPostal = false) {
        //si no hay localidad (caso solo para "toda españa") devuelve la provincia.

        if ($this->getLocalidad()->getIsCapital()) {
            $html = $this->getLocalidad();

            return $html;
        } else {
            $html = $this->getLocalidad() . ' (';
            if ($codigoPostal) {
                $html .= $this->getCodigopostal() == '' ? '' : $this->getCodigopostal() . ' - ';
            }
            $html .= $this->getStates() . ')';
            return $html;
        }

        return $this->getLocalidad();
    }

    /**
     * Devuelve el municipio y provincia. Si la localidad es capital, solo devuelve el municipio.
     *
     * @return string|City
     */
    public function getCMunicipioProvincia() {
        //si no hay localidad (caso solo para "toda españa") devuelve la provincia.
        $html = '';

        /*   if (null != $this->getCodigopostal()) {
          $html .= $this->getCodigopostal() . ' ';
          } */

        if ($this->getLocalidad()->getIsCapital()) {
            $html .= $this->getLocalidad();
            return $html;
        } elseif ($this->getCityId() == '') {
            $html .= $this->getStates();
            return $html;
        } else {
            $html .= $this->getLocalidad() . ' (';
            $html .= $this->getStates() . ')';
            return $html;
        }

        return $this->getLocalidad();
    }

    /**
     * Join as States EmpresaSectorUno EmpresaSectorDos EmpresaSectorTres Localidad
     * @param type $query
     * @return type
     */
    public static function doSelectJoinSector($query) {
        $rootAlias = $query->getRootAlias();
        $query = $query->select($rootAlias . '.*, esu.name')->leftJoin($rootAlias . '.EmpresaSectorUno esu');
        $query->select($rootAlias . '.*, esd.name')->leftJoin($rootAlias . '.EmpresaSectorDos esd');
        return $query->select($rootAlias . '.*, est.name')->leftJoin($rootAlias . '.EmpresaSectorTres est');
    }

    /**
     * Get Created at with format
     * @param type $format 
     */
    public function getFCreatedAt($format = 'D, d M Y H:i:s') {
        echo date($format, strtotime($this->getCreatedAt()));
    }

}