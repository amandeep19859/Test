<?php

/**
 * PizarraSectionMappingTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class PizarraSectionMappingTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object PizarraSectionMappingTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('PizarraSectionMapping');
    }
    
    
    /**
     * delete pizarra section records by pizarra id
     * @param String $pizarra_id
     */
    public function deleteRecordByPizarraId($pizarra_id){
      //create delete record query
      $delete_pizarra_record_query = Doctrine_Query::create()
                                                ->delete()
                                                ->from('PizarraSectionMapping psm')
                                                ->where('psm.pizarra_id =?', $pizarra_id);
      //delete records
      $delete_pizarra_record_query->execute();
    }
    
    /**
     * return section list from pizarra id
     * @param String $pizarra_id
     * @return Array
     */
    public function getSectionList($pizarra_id){
      //create sectio list query
      $section_list_query = Doctrine_Query::create()
                                          ->select('ps.id p_id, ps.short_name')
                                          ->from('PizarraSection ps,PizarraSectionMapping psm')
                                          ->where('psm.pizarra_id=?', $pizarra_id)
                                          ->andWhere('psm.pizarra_section_id = ps.id');
      $section_list_records = $section_list_query->fetchArray();
      
      $section_list = array();
      foreach($section_list_records as $index => $section){
        $section_list[$section['p_id']] = $section['short_name'];
      }
      
      return $section_list;
    }
}